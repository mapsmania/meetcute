<!DOCTYPE html>
<html>
<head>
  <title>Map Romance</title>
  <link href="https://unpkg.com/maplibre-gl/dist/maplibre-gl.css" rel="stylesheet" />
  <script src="https://unpkg.com/maplibre-gl/dist/maplibre-gl.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/rita"></script>
  <link href="https://fonts.googleapis.com/css2?family=Luckiest+Guy&family=EB+Garamond&display=swap" rel="stylesheet">

  <style>
    body, html {
      margin: 0;
      padding: 0;
      height: 100%;
      background: radial-gradient(circle, #fffde0 0%, #f0f0aa 100%);
      font-family: 'Luckiest Guy', cursive;
      display: flex;
      flex-direction: column;
    }
    #map {
      width: 100%;
      height: 70vh;
      z-index: 1;
      flex-shrink: 0;
    }
    #story-container {
      height: 60vh;
      overflow-y: auto;
      padding: 30px 20px;
      text-align: center;
      display: block;
      box-sizing: border-box;
    }
    .romance-story {
      font-family: 'EB Garamond', serif;
      font-size: 1.5em;
      width: 100%;
      max-width: 100%;
      color: #111;
      line-height: 1.6;
      padding: 0;
      margin: 0 auto;
      text-align: left;
      white-space: pre-wrap;
      text-shadow: none;
    }

      .story-title {
  text-align: center;
    margin-bottom: 0.5em;
}

  </style>
</head>
<body>
  <div id="map"></div>
  <div id="story-container">
    <div id="story-placeholder">Click on the map to generate a micro-romance story...</div>
  </div>

  <script>
    const map = new maplibregl.Map({
      container: 'map',
      style: 'love.json',
      center: [2.3522, 48.8566],
      zoom: 2
    });

    const storyContainer = document.getElementById('story-container');
    const storyPlaceholder = document.getElementById('story-placeholder');

  const romanceRules = {
 "start": "$title % $meet % $moment % $obstacle % $resolution | $title % $moment % $obstacle % $meet % $resolution",
    "title": "<div class='story-title'><b>When $boy met $girl - in $town</b></div>", 


  "person": "$boy | $girl",

       "girl" : "Emma | Olivia | Ava | Sophia | Isabella | Mia | Charlotte | Abigail | Emily | Harper | Amelia | Evelyn | Elizabeth | Sofia | Madison | Avery | Ella | Scarlett | Grace | Chloe | Victoria | Riley | Aria | Lily | Aubrey | Zoey | Penelope | Lillian | Addison | Layla | Natalie | Camila | Hannah | Brooklyn | Zoe | Nora | Leah | Savannah | Audrey | Claire | Eleanor | Skylar | Ellie | Samantha | Stella | Paisley | Violet | Mila | Allison | Alexa | Anna | Hazel | Aaliyah | Ariana | Lucy | Caroline | Sarah | Genesis | Kennedy | Sadie | Gabriella | Madelyn | Adeline | Maya | Autumn | Aurora | Piper | Hailey | Arianna | Kaylee | Ruby | Serenity | Eva | Naomi | Nevaeh | Alice | Luna | Bella | Quinn | Lydia | Peyton | Melanie | Kylie | Aubree | Mackenzie | Kinsley | Cora | Julia | Taylor | Katherine | Madeline | Gianna | Eliana | Elena | Vivian | Willow | Reagan | Brianna | Clara | Faith | Ashley | Emilia | Isabelle | Annabelle | Rylee | Valentina | Everly | Hadley | Sophie | Alexandra | Natalia | Ivy | Maria | Josephine | Delilah | Bailey | Jade | Ximena | Alexis | Alyssa | Brielle | Jasmine | Liliana | Adalynn | Khloe | Isla | Mary | Andrea | Kayla | Emery | London | Kimberly | Morgan | Lauren | Sydney | Nova | Trinity | Lyla | Margaret | Ariel | Adalyn | Athena | Lilly | Melody | Isabel | Jordyn | Jocelyn | Eden | Paige | Teagan | Valeria | Sara | Norah | Rose | Aliyah | Mckenzie | Molly | Raelynn | Leilani | Valerie | Emerson | Juliana | Nicole | Laila | Makayla | Elise | Mariah | Mya | Arya | Ryleigh | Adaline | Brooke | Rachel | Eliza | Angelina | Amy | Reese | Alina | Cecilia | Londyn | Gracie | Payton | Esther | Alaina | Charlie | Iris | Arabella | Genevieve | Finley | Daisy | Harmony | Anastasia | Kendall | Daniela | Catherine | Adelyn | Vanessa | Brooklynn | Juliette | Julianna | Presley | Summer | Destiny | Amaya | Hayden | Alana | Rebecca | Michelle | Eloise | Lila | Fiona | Callie | Lucia | Angela | Marley | Adriana | Parker | Alexandria | Giselle | Alivia | Alayna | Brynlee | Ana | Harley | Gabrielle | Dakota | Georgia | Juliet | Tessa | Leila | Kate | Jayla | Jessica | Lola | Stephanie | Sienna | Josie | Daleyza | Rowan | Evangeline | Hope | Maggie | Camille | Makenzie | Vivienne | Sawyer | Gemma | Joanna | Noelle | Elliana | Mckenna | Gabriela | Kinley | Rosalie | Brynn | Amiyah | Melissa | Adelaide | Malia | Ayla | Izabella | Delaney | Cali | Journey | Maci | Elaina | Sloane | June | Diana | Blakely | Aniyah | Olive | Jennifer | Paris | Miranda | Lena | Jacqueline | Paislee | Jane | Raegan | Lyric | Lilliana | Adelynn | Lucille | Selena | River | Annie | Cassidy | Jordan | Thea | Mariana | Amina | Miriam | Haven | Remi | Charlee | Blake | Lilah | Ruth | Amara | Kali | Kylee | Arielle | Emersyn | Alessandra | Fatima | Talia | Vera | Nina | Ariah | Allie | Addilyn | Keira | Catalina | Raelyn | Phoebe | Lexi | Zara | Makenna | Ember | Leia | Rylie | Angel | Haley | Madilyn | Kaitlyn | Heaven | Nyla | Amanda | Freya | Journee | Daniella | Danielle | Kenzie | Ariella | Lia | Brinley | Maddison | Shelby | Elsie | Kamila | Camilla | Alison | Ainsley | Ada | Laura | Kendra | Kayleigh | Adrianna | Madeleine | Joy | Juniper | Chelsea | Sage | Erin | Felicity | Gracelyn | Nadia | Skyler | Briella | Aspen | Myla | Heidi | Katie | Zuri | Jenna | Kyla | Kaia | Kira | Sabrina | Gracelynn | Gia | Amira | Alexia | Amber | Cadence | Esmeralda | Katelyn | Scarlet | Kamryn | Alicia | Miracle | Kelsey | Logan | Kiara | Bianca | Kaydence | Alondra | Evelynn | Christina | Lana | Aviana | Dahlia | Dylan | Anaya | Ashlyn | Jada | Kathryn | Jimena | Elle | Gwendolyn | April | Carmen | Mikayla | Annalise | Maeve | Camryn | Helen | Daphne | Braelynn | Carly | Cheyenne | Leslie | Veronica | Nylah | Kennedi | Skye | Evie | Averie | Harlow | Allyson | Carolina | Tatum | Francesca | Aylin | Ashlynn | Sierra | Mckinley | Leighton | Maliyah | Annabella | Megan | Margot | Luciana | Mallory | Millie | Regina | Nia | Rosemary | Saylor | Abby | Briana | Phoenix | Viviana | Alejandra | Frances | Jayleen | Serena | Lorelei | Zariah | Ariyah | Jazmin | Avianna | Carter | Marlee | Eve | Aleah | Remington | Amari | Bethany | Fernanda | Malaysia | Willa | Liana | Ryan | Addyson | Yaretzi | Colette | Macie | Selah | Nayeli | Madelynn | Michaela | Priscilla | Janelle | Samara | Justice | Itzel | Emely | Lennon | Aubrie | Julie | Kyleigh | Sarai | Braelyn | Alani | Lacey | Edith | Elisa | Macy | Marilyn | Baylee | Karina | Raven | Celeste | Adelina | Matilda | Kara | Jamie | Charleigh | Aisha | Kassidy | Hattie | Karen | Sylvia | Winter | Aleena | Angelica | Magnolia | Cataleya | Danna | Henley | Mabel | Kelly | Brylee | Jazlyn | Virginia | Helena | Jillian | Madilynn | Blair | Galilea | Kensley | Wren | Bristol | Emmalyn | Holly | Lauryn | Cameron | Hanna | Meredith | Royalty | Sasha | Lilith | Jazmine | Alayah | Madisyn | Cecelia | Renata | Lainey | Liberty | Brittany | Savanna | Imani | Kyra | Mira | Mariam | Tenley | Aitana | Gloria | Maryam | Giuliana | Skyla | Anne | Johanna | Myra | Charley | Tiffany | Beatrice | Karla | Cynthia | Janiyah | Melany | Alanna | Lilian | Demi | Pearl | Jaylah | Maia | Cassandra | Jolene | Crystal | Everleigh | Maisie | Anahi | Elianna | Hallie | Ivanna | Oakley | Ophelia | Emelia | Mae | Marie | Rebekah | Azalea | Haylee | Bailee | Anika | Monica | Kimber | Sloan | Jayda | Anya | Bridget | Kailey | Julissa | Marissa | Leona | Aileen | Addisyn | Kaliyah | Coraline | Dayana | Kaylie | Celine | Jaliyah | Elaine | Lillie | Melina | Jaelyn | Shiloh | Jemma | Madalyn | Addilynn | Alaia | Mikaela | Adley | Saige | Angie | Dallas | Braylee | Elsa | Emmy | Hayley | Siena | Lorelai | Miah | Royal | Tiana | Elliot | Kori | Greta | Charli | Elliott | Julieta | Alena | Rory | Harlee | Rosa | Ivory | Guadalupe | Jessie | Laurel | Annika | Clarissa | Karsyn | Collins | Kenia | Milani | Alia | Chanel | Dorothy | Armani | Emory | Ellen | Irene | Adele | Jaelynn | Myah | Hadassah | Jayde | Lilyana | Malaya | Kenna | Amelie | Reyna | Teresa | Angelique | Linda | Nathalie | Kora | Zahra | Aurelia | Kalani | Rayna | Jolie | Sutton | Aniya | Jessa | Laylah | Esme | Keyla | Ariya | Elisabeth | Marina | Mara | Meadow | Aliza | Zelda | Lea | Elyse | Monroe | Penny | Lilianna | Lylah | Liv | Scarlette | Kadence | Ansley | Emilee | Perla | Annabel | Alaya | Milena | Karter | Avah | Amirah | Leyla | Livia | Chaya | Wynter | Jaycee | Lailah | Amani | Milana | Lennox | Remy | Zariyah | Clare | Hadlee | Kiera | Rosie | Alma | Kaelyn | Eileen | Jayden | Martha | Noa | Christine | Ariadne | Natasha | Emerie | Tatiana | Joselyn | Joyce | Salma | Amiya | Audrina | Kinslee | Jaylene | Analia | Erika | Lexie | Mina | Patricia | Dulce | Poppy | Aubrielle | Clementine | Lara | Amaris | Milan | Aliana | Kailani | Kaylani | Maleah | Belen | Simone | Whitney | Elora | Claudia | Gwen | Rylan | Antonella | Khaleesi | Arely | Princess | Kenley | Itzayana | Karlee | Paulina | Laney | Bria | Chana | Kynlee | Astrid | Giovanna | Lindsey | Sky | Aryanna | Ayleen | Azariah | Joelle | Nala | Tori | Noemi | Breanna | Emmeline | Mavis | Amalia | Mercy | Tinley | Averi | Aiyana | Alyson | Corinne | Leanna | Madalynn | Briar | Jaylee | Kailyn | Kassandra | Kaylin | Nataly | Amia | Yareli | Cara | Taliyah | Thalia | Carolyn | Estrella | Montserrat | Zaylee | Anabelle | Deborah | Frida | Zaria | Kairi | Katalina | Nola | Erica | Isabela | Jazlynn | Paula | Faye | Louisa | Alessia | Courtney | Reign | Ryann | Stevie | Heavenly | Lisa | Roselyn | Raina | Adrienne | Celia | Estelle | Marianna | Brenda | Kathleen | Paola | Hunter | Ellis | Hana | Lina | Raquel | Aliya | Iliana | Kallie | Emmalynn | Naya | Reina | Wendy | Landry | Barbara | Casey | Karlie | Kiana | Rivka | Kenya | Aya | Carla | Dalary | Jaylynn | Sariah | Andi | Romina | Dana | Danica | Ingrid | Kehlani | Zaniyah | Alannah | Avalynn | Evalyn | Sandra | Veda | Hadleigh | Paityn | Abril | Ciara | Holland | Lillianna | Kai | Bryleigh | Emilie | Carlee | Judith | Kristina | Janessa | Annalee | Zoie | Maliah | Bonnie | Emmaline | Louise | Kaylynn | Monserrat | Nancy | Noor | Vada | Aubriella | Maxine | Nathalia | Tegan | Aranza | Emmie | Brenna | Estella | Ellianna | Kailee | Ailani | Caylee | Zainab | Zendaya | Jana | Julianne | Ellison | Sariyah | Lizbeth | Susan | Alyvia | Jewel | Marjorie | Marleigh | Nathaly | Sharon | Yamileth | Zion | Mariyah | Lyra | Belle | Yasmin | Kaiya | Maren | Marisol | Vienna | Calliope | Hailee | Rayne | Tabitha | Anabella | Blaire | Giana | Milania | Paloma | Amya | Novalee | Harleigh | Ramona | Rhea | Aadhya | Miya | Desiree | Frankie | Sylvie | Jasmin | Moriah | Rosalyn | Kaya | Joslyn | Tinsley | Farrah | Aislinn | Halle | Madyson | Micah | Arden | Bexley | Ari | Aubri | Ayana | Cherish | Davina | Anniston | Riya | Adilynn | Ally | Amayah | Harmoni | Heather | Saoirse | Azaria | Alisha | Nalani | Maylee | Shayla | Briley | Elin | Lilia | Ann | Antonia | Aryana | Chandler | Esperanza | Lilyanna | Alianna | Luz | Meilani",
        "boy" : "Niko | Aleksei | Noah | Liam | William | Mason | James | Benjamin | Jacob | Michael | Elijah | Ethan | Alexander | Oliver | Daniel | Lucas | Matthew | Aiden | Jackson | Logan | David | Joseph | Samuel | Henry | Owen | Sebastian | Gabriel | Carter | Jayden | John | Luke | Anthony | Isaac | Dylan | Wyatt | Andrew | Joshua | Christopher | Grayson | Jack | Julian | Ryan | Jaxon | Levi | Nathan | Caleb | Hunter | Christian | Isaiah | Thomas | Aaron | Lincoln | Charles | Eli | Landon | Connor | Josiah | Jonathan | Cameron | Jeremiah | Mateo | Adrian | Hudson | Robert | Nicholas | Brayden | Nolan | Easton | Jordan | Colton | Evan | Angel | Asher | Dominic | Austin | Leo | Adam | Jace | Jose | Ian | Cooper | Gavin | Carson | Jaxson | Theodore | Jason | Ezra | Chase | Parker | Xavier | Kevin | Zachary | Tyler | Ayden | Elias | Bryson | Leonardo | Greyson | Sawyer | Roman | Brandon | Bentley | Kayden | Ryder | Nathaniel | Vincent | Miles | Santiago | Harrison | Tristan | Declan | Cole | Maxwell | Luis | Justin | Everett | Micah | Axel | Wesley | Max | Silas | Weston | Ezekiel | Juan | Damian | Camden | George | Braxton | Blake | Jameson | Diego | Carlos | Ivan | Kingston | Ashton | Jesus | Brody | Emmett | Abel | Jayce | Maverick | Bennett | Giovanni | Eric | Maddox | Kaiden | Kai | Bryce | Alex | Calvin | Ryker | Jonah | Luca | King | Timothy | Alan | Brantley | Malachi | Emmanuel | Abraham | Antonio | Richard | Jude | Miguel | Edward | Victor | Amir | Joel | Steven | Matteo | Hayden | Patrick | Grant | Preston | Tucker | Jesse | Finn | Oscar | Kaleb | Gael | Graham | Elliot | Alejandro | Rowan | Marcus | Jeremy | Zayden | Karter | Beau | Bryan | Maximus | Aidan | Avery | Elliott | August | Nicolas | Mark | Colin | Waylon | Bradley | Kyle | Kaden | Xander | Caden | Paxton | Brian | Dean | Paul | Peter | Kenneth | Jasper | Lorenzo | Zane | Zion | Beckett | River | Jax | Andres | Dawson | Messiah | Jaden | Rhett | Brady | Lukas | Omar | Jorge | Riley | Derek | Charlie | Emiliano | Griffin | Myles | Brooks | Israel | Sean | Judah | Iker | Javier | Erick | Tanner | Corbin | Adriel | Jase | Jake | Simon | Cayden | Knox | Tobias | Felix | Milo | Jayceon | Gunner | Francisco | Kameron | Cash | Remington | Reid | Cody | Martin | Andre | Rylan | Maximiliano | Zander | Archer | Barrett | Killian | Stephen | Clayton | Thiago | Spencer | Amari | Josue | Holden | Emilio | Arthur | Chance | Eduardo | Leon | Travis | Ricardo | Damien | Manuel | Gage | Keegan | Titus | Raymond | Kyrie | Nash | Finley | Fernando | Louis | Peyton | Rafael | Phoenix | Jaiden | Lane | Dallas | Emerson | Cristian | Collin | Kyler | Devin | Jeffrey | Walter | Anderson | Cesar | Mario | Donovan | Seth | Garrett | Enzo | Conner | Legend | Caiden | Beckham | Jett | Ronan | Troy | Karson | Edwin | Hector | Cohen | Ali | Trevor | Conor | Orion | Shane | Andy | Marco | Walker | Angelo | Quinn | Dalton | Sergio | Ace | Tyson | Johnny | Dominick | Colt | Johnathan | Gideon | Julius | Cruz | Edgar | Prince | Dante | Marshall | Ellis | Joaquin | Major | Arlo | Alexis | Reed | Muhammad | Frank | Theo | Shawn | Erik | Grady | Nehemiah | Daxton | Atticus | Gregory | Matias | Bodhi | Emanuel | Jensen | Kash | Romeo | Desmond | Solomon | Allen | Jaylen | Leonel | Roberto | Pedro | Kason | Fabian | Clark | Dakota | Abram | Noel | Kayson | Malik | Odin | Jared | Warren | Kendrick | Rory | Jonas | Adan | Ibrahim | Trenton | Finnegan | Landen | Adonis | Jay | Ruben | Drew | Gunnar | Ismael | Jaxton | Kane | Hendrix | Atlas | Pablo | Zaiden | Wade | Russell | Cade | Sullivan | Malcolm | Kade | Harvey | Princeton | Skyler | Corey | Esteban | Leland | Derrick | Ari | Kamden | Zayn | Porter | Franklin | Raiden | Braylon | Ronald | Cyrus | Benson | Malakai | Hugo | Marcos | Maximilian | Hayes | Philip | Lawson | Phillip | Bruce | Braylen | Zachariah | Damon | Dexter | Enrique | Aden | Lennox | Drake | Khalil | Tate | Zayne | Milan | Brock | Brendan | Armando | Gerardo | Jamison | Rocco | Nasir | Augustus | Sterling | Dillon | Royal | Royce | Moses | Jaime | Johan | Scott | Chandler | Raul | Remy | Cason | Luka | Mohamed | Deacon | Winston | Albert | Pierce | Taylor | Nikolai | Bowen | Danny | Francis | Brycen | Jayson | Moises | Keith | Hank | Quentin | Kasen | Donald | Julio | Davis | Alec | Kolton | Lawrence | Rhys | Kian | Nico | Matthias | Kellan | Mathias | Ariel | Justice | Braden | Rodrigo | Ryland | Leonidas | Jerry | Ronin | Alijah | Kobe | Lewis | Dennis | Luciano | Ahmed | Frederick | Darius | Arjun | Dax | Asa | Nixon | Ezequiel | Eden | Tony | Landyn | Emmitt | Mathew | Kyson | Otto | Saul | Uriel | Colby | Dustin | Omari | Raphael | Brennan | Callen | Keaton | Arturo | Isaias | Roy | Kieran | Ty | Dorian | Cannon | Marvin | Cullen | Sage | Uriah | Darren | Cayson | Aarav | Case | Izaiah | Armani | Gustavo | Jimmy | Alberto | Duke | Rayan | Chris | Casey | Roland | Moshe | Curtis | Mauricio | Alonzo | Yusuf | Nikolas | Soren | Hamza | Jasiah | Alfredo | Devon | Jalen | Raylan | Edison | Jamari | Oakley | Samson | Lionel | Reece | Sam | Quincy | Jakob | Apollo | Kingsley | Ahmad | Bryant | Alvin | Trey | Mohammed | Conrad | Mitchell | Salvador | Quinton | Bo | Mohammad | Elian | Gianni | Lennon | Leonard | Douglas | Cassius | Ricky | Carl | Gary | Larry | Colten | Ramon | Kellen | Korbin | Wilson | Kylan | Santino | Niko | Issac | Jagger | Lance | Joe | Julien | Orlando | Jefferson | Memphis | Crosby | Mekhi | Nelson | Lucian | Ayaan | Nathanael | Neil | Makai | Finnley | Rex | Forrest | Layton | Randy | Boston | Tristen | Tatum | Brayan | Sylas | Thaddeus | Trent | Morgan | Roger | Abdullah | Casen | Maurice | Sincere | Titan | Kyree | Talon | Fletcher | Langston | Eddie | Briggs | Noe | Kamari | Rowen | Zeke | Aldo | Kaison | Valentino | Vihaan | Alden | Terry | Bruno | Canaan | Lee | Byron | Kohen | Reese | Braydon | Madden | Deandre | Flynn | Harley | Hezekiah | Amos | Harry | Zain | Alessandro | Stanley | Lucca | Branson | Ernesto | Joziah | Leandro | Ares | Marc | Blaine | Joey | Jon | Yosef | Carmelo | Franco | Jamal | Mack | Kristian | Dane | Lachlan | Callum | Graysen | Kye | Ben | Aryan | Gannon | London | Kareem | Stetson | Kristopher | Tomas | Ford | Bronson | Enoch | Baylor | Kaysen | Axton | Jaxen | Rodney | Dominik | Emery | Layne | Wilder | Jamir | Tripp | Kelvin | Vicente | Augustine | Brett | Callan | Clay | Crew | Brecken | Jacoby | Abdiel | Allan | Maxton | Melvin | Rayden | Terrance | Demetrius | Rohan | Wayne | Yahir | Arian | Fox | Brentley | Ray | Zechariah | Cain | Guillermo | Otis | Tommy | Alonso | Dariel | Jedidiah | Maximo | Cory | Grey | Reyansh | Skylar | Marcelo | Castiel | Kase | Toby | Bobby | Jadiel | Marcel | Lochlan | Jeffery | Zackary | Fisher | Yousef | Aron | Chaim | Felipe | Axl | Anakin | Brodie | Dash | Anson | Maison | Zaire | Samir | Damari | Elisha | Davion | Eugene | Hassan | Kannon | Azariah | Clyde | Harper | Nickolas | Boone | Magnus | Coen | Kole | Willie | Chad | Xzavier | Duncan | Harold | Houston | Landry | Trace | Alvaro | Ameer | Junior | Kamdyn | Vincenzo | Gerald | Marlon | Payton | Jamie | Kamryn | Camdyn | Anders | Aydin | Bentlee | Reginald | Jaziel | Benton | Bodie | Misael | Westin | Will | Channing | Harlan | Kody | Kolten | Thatcher | Valentin | Henrik | Keenan | Terrence | Denver | Emory | Jerome | Jermaine | Cairo | Sonny | Mayson | Alfred | Cristiano | Darian | Eliseo | Maxim | Stefan | Hugh | Santana | Javion | Leighton | Miller | Riaan | Rogelio | Rudy | Blaze | Bridger | Darwin | Markus | Ronnie | Shepherd | Vaughn | Billy | Marley | Huxley | Rey | Keagan | Draven | Shiloh | Brysen | Giovani | Alistair | Brixton | Heath | Kalel | Reuben | Ridge | Adrien | Rene | Sutton | Zyaire | Ephraim | Neymar | Vance | Zavier | Jessie | Dangelo | Dayton | Emmet | Ishaan | Zaid | Camron | Jordy | Kenny | Micheal | Shaun | Alexzander | Howard | Kylo | Eason | Blaise | Craig | Hakeem | Karim | Jabari | Jairo | Khalid | Turner | Van | Westley | Braiden | Cedric | Darrell | Louie | Mustafa | Yehuda | Justus | Salvatore | Alfonso | Kendall | Konnor | Lamar | Gibson | Ignacio | Koda | Leroy | Terrell | Tristian | Achilles | Jericho | Ramiro | Yahya | Rolando | Vivaan | Dario | Jair | Ulises | Judson | Kashton | Tadeo | Marquis | Avi | Dimitri | Dwayne | Musa | Ahmir | Gordon | Ira | Seamus | Kolby | Brantlee | Javon | Rocky | Urijah | Brayson | Mikael | Santos | Gilbert | Greysen | Lyric | Coleman | Dominique | Foster | Gauge | Harris | Kymani | Leif | Agustin | Keanu | Konner | Brent | Immanuel | Benicio | Ernest | Merrick | Yisroel | Amare | Jad | Lyle | Creed | Krish | Maddux | Camilo | Giancarlo | Jamarion | Steve | Anton | Jamar | Jeremias | Ralph | Wesson | Bode | Braeden | Brenden | Eliezer | Davian | Gus | Jonathon",


  // Beat 1: Boy meets girl
  "meet": "In the heart of $town, $boy saw $girl at the $place. | $boy was lost in $town when $girl, offered directions — and maybe more. | $boy first saw $girl beneath the $season sky in $town. | At the $place in $town, their eyes met and the world shifted. | $boy and $girl kept running into each other at the $place in $town — was it fate or just coincidence? | $boy first saw $girl standing in the rain outside the $place in $town. He offered to share his umbrella. | $boy was wandering around $town when he stumbled upon $girl in the $place. | $boy and %girl first crossed paths beneath the $season sky in $town.",

  // Atmospheric beat after the meeting
  "moment": "He smiled as if nothing had changed, though everything had. | She looked away pretending not to care , but her hands trembled. | The scent of coffee and rain made time collapse into a single heartbeat. | He said her name soft as fog. | All sound in the $place faded away until only her laugh remained. | A thousand words passed in the looks between them.",


  // Beat 2: Obstacle separates them
  "obstacle": "But $obstacleType stood in their way. | Yet there was $obstacleType, keeping them apart. | Their hearts were tangled, but $obstacleType loomed between them. | Some loves start with passion; but theirs cooled under $obstacleType | Before their love story even began $obstacleType threatened to end it.",

      "obstacleType": "distance | an old promise | her departure date | his silence | a misunderstanding | her family’s disapproval | his fear of commitment | her lack of trust | past betrayals | their different backgrounds | her burning ambition | a rival for her affection | his job offer in a new city | their pasts returning to haunt them",

 "resolution": "Still, love found a way, and they walked on together. | In the end they chose each other, no matter the cost. | This time, they didn’t let go. | Some obstacles bend; this one broke. | Not every love survives — but theirs still lingers in $town. | Against all odds, they found their way back to each other. | Love, as it turned out, was stronger than $obstacleType. | They parted ways, but never truly left each other’s hearts. | Sometimes love isn’t enough—but oh, how they tried. | The last train out of $town took her away—forever. | Little did they know, fate would bring them back together years later. | Was it love? Or just the way the light hit her hair that day in $town? | Some stories don’t have endings. This was one of them. | Love, as it turned out, was stronger than $obstacleType. | Not every love survives — especially not against $obstacleType. | They overcame $obstacleType, and in doing so, they found themselves.",

      
  "season": "autumn | winter | spring | summer | fall",
  "place": "cafe | bookstore | train station | river path | square | corner shop | rooftop bar | garden | shopping mall | church"
};

    async function fetchNearestTown(lat, lon) {
      const query = `
        [out:json];
        (
          node["place"~"town|village|city"](around:10000,${lat},${lon});
        );
        out center 1;
      `;

      try {
        const response = await fetch('https://overpass-api.de/api/interpreter', {
          method: 'POST',
          body: query
        });

        if (!response.ok) throw new Error('Overpass API request failed');
        const data = await response.json();

        if (data.elements && data.elements.length > 0) {
          data.elements.sort((a, b) => {
            const distA = Math.hypot(a.lat - lat, a.lon - lon);
            const distB = Math.hypot(b.lat - lat, b.lon - lon);
            return distA - distB;
          });
          return data.elements[0].tags.name || "this place";
        }
        return "this place";
      } catch (err) {
        console.error("Overpass error:", err);
        return "this place";
      }
    }

  function generateRomanceStory(town) {
  // Clean and capitalize town name
  let cleanTown = town.replace(/[^a-zA-Z\s-']/g, '').trim();
  let capitalizedTown = cleanTown.charAt(0).toUpperCase() + cleanTown.slice(1);

  // Clone grammar rules
  let currentRules = JSON.parse(JSON.stringify(romanceRules));

  // Pick fixed boy and girl names
  let boyList = currentRules.boy.split('|').map(n => n.trim());
  let girlList = currentRules.girl.split('|').map(n => n.trim());

  let chosenBoy = boyList[Math.floor(Math.random() * boyList.length)];
  let chosenGirl = girlList[Math.floor(Math.random() * girlList.length)];

  // Inject fixed values into grammar
  currentRules.boy = chosenBoy;
  currentRules.girl = chosenGirl;
  currentRules.town = capitalizedTown;

  // Expand grammar
  let grammar = RiTa.grammar(currentRules);
  let rawStory = grammar.expand(); // This will contain $title % $meet % etc.

  // Split on % markers
  const parts = rawStory.split('%').map(s => s.trim());

  // First part is the title (keep HTML intact)
  let title = parts[0];

  // The rest of the story
  let bodyParts = parts.slice(1).map(s => {
    if (!/[.!?]$/.test(s)) s += '.';
    return s.charAt(0).toUpperCase() + s.slice(1);
  });

  // Join title + body
  return title + bodyParts.join(' ');
}



  map.on('click', async (e) => {
      const lat = e.lngLat.lat;
      const lon = e.lngLat.lng;

      storyPlaceholder.textContent = "Fetching town and writing romance...";

      const town = await fetchNearestTown(lat, lon);
      const story = generateRomanceStory(town);

      storyContainer.innerHTML = '';
      const storyDiv = document.createElement('div');
      storyDiv.className = 'romance-story';
      storyDiv.innerHTML = story;
      storyContainer.appendChild(storyDiv);
    });

    // romantic place-names

     map.on('load', () => {
  const layers = ['label_city', 'label_city_capital', 'label_town'];

 const textExpression = [
  'case',
  ['==', ['slice', ['get', 'name'], 0, 1], 'S'],
  ['concat', 'Sleepless in ', ['get', 'name']],

  ['==', ['slice', ['get', 'name'], 0, 1], 'L'],
  ['concat', 'Love in ', ['get', 'name']],

  ['==', ['slice', ['get', 'name'], 0, 1], 'R'],
  ['concat', ['get', 'name'], ' Romance'],

  ['==', ['slice', ['get', 'name'], 0, 1], 'A'],
  ['concat', 'An Affair in ', ['get', 'name']],

  ['==', ['upcase', ['slice', ['get', 'name'], 0, 1]], 'B'],
  ['concat', 'Beloved ', ['get', 'name']],

  ['==', ['slice', ['get', 'name'], 0, 1], 'C'],
  ['concat', 'Caught in ', ['get', 'name']],

  ['==', ['upcase', ['slice', ['get', 'name'], 0, 1]], 'D'],
  ['concat', ['get', 'name'], ' Dreams'],

  ['==', ['upcase', ['slice', ['get', 'name'], 0, 1]], 'E'],
  ['concat', ['get', 'name'], ' In My Eyes'],

  ['==', ['slice', ['get', 'name'], 0, 1], 'F'],
  ['concat', 'Forever in ', ['get', 'name']],

  ['==', ['slice', ['get', 'name'], 0, 1], 'G'],
  ['concat', 'A Gentle ', ['get', 'name'], ' Embrace'],

  ['==', ['upcase', ['slice', ['get', 'name'], 0, 1]], 'H'],
  ['concat', ['get', 'name'], ' Hearts'],

  ['==', ['slice', ['get', 'name'], 0, 1], 'I'],
  ['concat', 'Idolized in ', ['get', 'name']],

  ['==', ['upcase', ['slice', ['get', 'name'], 0, 1]], 'J'],
  ['concat', ['get', 'name'], ' Journey'],

  ['==', ['slice', ['get', 'name'], 0, 1], 'K'],
  ['concat', 'Kissing in ', ['get', 'name']],

  ['==', ['upcase', ['slice', ['get', 'name'], 0, 1]], 'M'],
  ['concat', ['get', 'name'], ' Memories'],

  ['==', ['slice', ['get', 'name'], 0, 1], 'N'],
  ['concat', 'A Night in ', ['get', 'name']],

  ['==', ['upcase', ['slice', ['get', 'name'], 0, 1]], 'O'],
  ['concat', ['get', 'name'], ' Oasis'],
            
  ['==', ['slice', ['get', 'name'], 0, 1], 'P'],
  ['concat', 'Passion in ', ['get', 'name']],

  ['==', ['slice', ['get', 'name'], 0, 1], 'T'],
  ['concat', 'Together in ', ['get', 'name']],
     
  ['==', ['slice', ['get', 'name'], 0, 1], 'V'],
  ['concat', 'Valentines in ', ['get', 'name']],

  ['==', ['upcase', ['slice', ['get', 'name'], 0, 1]], 'W'],
  ['concat', ['get', 'name'], ' Waltz'],

  ['==', ['slice', ['get', 'name'], 0, 1], 'Y'],
  ['concat', 'Yours in ', ['get', 'name']],
   

    // Otherwise, keep the original name
    ['get', 'name']
  ];

  layers.forEach(id => {
    map.setLayoutProperty(id, 'text-field', textExpression);
    map.setLayoutProperty(id, 'text-font', ['Noto Sans Regular']);
  });
});
  </script>
</body>
</html>
